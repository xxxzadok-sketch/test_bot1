2# add_missing_items.py
from database import Database


def add_missing_hookahs():
    """–î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–∞–ª—å—è–Ω—ã –≤ –±–∞–∑—É"""
    db = Database()
    cursor = db.conn.cursor()

    # –í—Å–µ –∫–∞–ª—å—è–Ω—ã –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å
    hookahs_to_add = [
        ('–ü–µ–Ω—Å–∏–æ–Ω–Ω—ã–π', 800, '–ö–∞–ª—å—è–Ω—ã'),
        ('–°—Ç–∞–Ω–¥–∞—Ä—Ç', 1000, '–ö–∞–ª—å—è–Ω—ã'),
        ('–ü—Ä–µ–º–∏—É–º', 1200, '–ö–∞–ª—å—è–Ω—ã'),
        ('–§—Ä—É–∫—Ç–æ–≤–∞—è —á–∞—à–∞', 1500, '–ö–∞–ª—å—è–Ω—ã'),
        ('–°–∏–≥–∞—Ä–Ω—ã–π', 1500, '–ö–∞–ª—å—è–Ω—ã'),
        ('–ü–∞—Ä—Ñ—é–º', 2000, '–ö–∞–ª—å—è–Ω—ã')
    ]

    print("üîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–∞–ª—å—è–Ω–æ–≤...")

    added_count = 0
    for name, price, category in hookahs_to_add:
        try:
            cursor.execute(
                'INSERT INTO menu_items (name, price, category) VALUES (?, ?, ?)',
                (name, price, category)
            )
            print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω: {name} - {price}‚ÇΩ ({category})")
            added_count += 1
        except Exception as e:
            if "UNIQUE constraint" in str(e):
                print(f"‚ö†Ô∏è  –£–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: {name}")
            else:
                print(f"‚ùå –û—à–∏–±–∫–∞ —Å {name}: {e}")

    db.conn.commit()
    print(f"\nüéØ –î–æ–±–∞–≤–ª–µ–Ω–æ {added_count} –Ω–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π")


def repopulate_all_menu():
    """–ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–æ–ª–Ω–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –º–µ–Ω—é"""
    db = Database()
    cursor = db.conn.cursor()

    print("üîÑ –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ–Ω—é...")

    # –û—á–∏—â–∞–µ–º —Ç–∞–±–ª–∏—Ü—É
    cursor.execute('DELETE FROM menu_items')
    print("‚úÖ –¢–∞–±–ª–∏—Ü–∞ –æ—á–∏—â–µ–Ω–∞")

    # –í—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –º–µ–Ω—é
    all_menu_items = [
        # –ö–∞–ª—å—è–Ω—ã
        ('–ü–µ–Ω—Å–∏–æ–Ω–Ω—ã–π', 800, '–ö–∞–ª—å—è–Ω—ã'),
        ('–°—Ç–∞–Ω–¥–∞—Ä—Ç', 1000, '–ö–∞–ª—å—è–Ω—ã'),
        ('–ü—Ä–µ–º–∏—É–º', 1200, '–ö–∞–ª—å—è–Ω—ã'),
        ('–§—Ä—É–∫—Ç–æ–≤–∞—è —á–∞—à–∞', 1500, '–ö–∞–ª—å—è–Ω—ã'),
        ('–°–∏–≥–∞—Ä–Ω—ã–π', 1500, '–ö–∞–ª—å—è–Ω—ã'),
        ('–ü–∞—Ä—Ñ—é–º', 2000, '–ö–∞–ª—å—è–Ω—ã'),

        # –ù–∞–ø–∏—Ç–∫–∏
        ('–í–æ–¥–∞', 100, '–ù–∞–ø–∏—Ç–∫–∏'),
        ('–ö–æ–ª–∞ 0,5–ª', 100, '–ù–∞–ø–∏—Ç–∫–∏'),
        ('–ö–æ–ª–∞/–§–∞–Ω—Ç–∞/–°–ø—Ä–∞–π—Ç 1–ª', 200, '–ù–∞–ø–∏—Ç–∫–∏'),
        ('–ü–∏–≤–æ/–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫', 200, '–ù–∞–ø–∏—Ç–∫–∏'),

        # –ö–æ–∫—Ç–µ–π–ª–∏
        ('–í/–∫–æ–ª–∞', 400, '–ö–æ–∫—Ç–µ–π–ª–∏'),
        ('–°–∞–Ω—Ä–∞–π–∑', 400, '–ö–æ–∫—Ç–µ–π–ª–∏'),
        ('–õ–∞–≥—É–Ω–∞', 400, '–ö–æ–∫—Ç–µ–π–ª–∏'),
        ('–§–∏–µ—Ä–æ', 400, '–ö–æ–∫—Ç–µ–π–ª–∏'),
        ('–ü—Ä–æ–±–∏—Ä–∫–∏', 600, '–ö–æ–∫—Ç–µ–π–ª–∏'),

        # –ß–∞–π
        ("–î–∞ –•—É–Ω –ü–∞–æ", 400, "–ß–∞–π"),
        ("–¢–µ –ì—É–∞–Ω—å –ò–Ω—å", 400, "–ß–∞–π"),
        ("–®—É –ø—É—ç—Ä", 400, "–ß–∞–π"),
        ("–°—è–æ –ß–∂—É–Ω", 400, "–ß–∞–π"),
        ("–Æ—ç –ì—É–∞–Ω –ë–∞–π", 400, "–ß–∞–π"),
        ("–ì–∞–±–∞", 400, "–ß–∞–π"),
        ("–ì—Ä–µ—á–∏—à–Ω—ã–π", 400, "–ß–∞–π"),
        ("–ú–µ–¥–æ–≤–∞—è –¥—ã–Ω—è", 400, "–ß–∞–π"),
        ("–ú–∞–ª–∏–Ω–∞/–ú—è—Ç–∞", 400, "–ß–∞–π"),
        ("–ù–∞–≥–ª—ã–π —Ñ—Ä—É–∫—Ç", 400, "–ß–∞–π"),
        ("–í–∏—à–Ω–µ–≤—ã–π –ø—É—ç—Ä", 500, "–ß–∞–π"),
        ("–ú–∞—Ä–æ–∫–∫–∞–Ω—Å–∫–∏–π", 500, "–ß–∞–π"),
        ("–ì–æ–ª—É–±–∏–∫–∞", 500, "–ß–∞–π"),
        ("–°–º–æ—Ä–æ–¥–∏–Ω–æ–≤—ã–π", 500, "–ß–∞–π"),
        ("–ö–ª—É–±–Ω–∏—á–Ω—ã–π", 500, "–ß–∞–π"),
        ("–û–±–ª–µ–ø–∏—Ö–æ–≤—ã–π", 500, "–ß–∞–π")
    ]

    # –î–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏
    for name, price, category in all_menu_items:
        try:
            cursor.execute(
                'INSERT INTO menu_items (name, price, category) VALUES (?, ?, ?)',
                (name, price, category)
            )
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å {name}: {e}")

    db.conn.commit()
    print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(all_menu_items)} –ø–æ–∑–∏—Ü–∏–π –≤ –º–µ–Ω—é")


if __name__ == "__main__":
    print("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:")
    print("1 - –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–∞–ª—å—è–Ω—ã")
    print("2 - –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–∑–∞–ø–æ–ª–Ω–∏—Ç—å –º–µ–Ω—é")

    choice = input("–í–≤–µ–¥–∏—Ç–µ 1 –∏–ª–∏ 2: ")

    if choice == "1":
        add_missing_hookahs()
    elif choice == "2":
        repopulate_all_menu()
    else:
        print("‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä")